<!-- User Profile Modals - Include this in all pages -->

<!-- Change Password Modal -->
<div id="changePasswordModal" class="modal-overlay" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-header">
            <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px; vertical-align: middle; margin-right: 10px;">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                </svg>
                Change Password
            </h3>
            <button class="modal-close" onclick="closeChangePasswordModal()">&times;</button>
        </div>
        <div class="modal-body">
            <form id="changePasswordForm" onsubmit="submitPasswordChange(event)">
                <div class="form-group">
                    <label for="currentPassword">Current Password *</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="currentPassword" required autocomplete="current-password">
                        <button type="button" class="toggle-password-btn" onclick="togglePasswordVisibility('currentPassword')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </div>
                    <span class="error-text" id="currentPasswordError"></span>
                </div>

                <div class="form-group">
                    <label for="newPassword">New Password *</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="newPassword" required minlength="8" autocomplete="new-password">
                        <button type="button" class="toggle-password-btn" onclick="togglePasswordVisibility('newPassword')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </div>
                    <small class="helper-text">Minimum 8 characters</small>
                    <div class="password-strength" id="passwordStrength"></div>
                </div>

                <div class="form-group">
                    <label for="confirmPassword">Confirm New Password *</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="confirmPassword" required minlength="8" autocomplete="new-password">
                        <button type="button" class="toggle-password-btn" onclick="togglePasswordVisibility('confirmPassword')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </div>
                    <span class="error-text" id="confirmPasswordError"></span>
                </div>

                <div class="form-group">
                    <a href="#" class="forgot-password-link" onclick="alert('Please contact the fishery management for password reset:\\n\\nMichael: 07749 135709\\nRoss: 07979 521146'); return false;">
                        Forgot your password?
                    </a>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeChangePasswordModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Password</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Change Profile Image Modal -->
<div id="changeImageModal" class="modal-overlay" style="display: none;">
    <div class="modal-dialog modal-large">
        <div class="modal-header">
            <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px; vertical-align: middle; margin-right: 10px;">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                Change Profile Image
            </h3>
            <button class="modal-close" onclick="closeChangeImageModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="image-upload-section">
                <div class="upload-area" id="uploadArea" onclick="document.getElementById('imageUpload').click()">
                    <input type="file" id="imageUpload" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    <p>Click to upload or drag and drop</p>
                    <small>PNG, JPG or GIF (max. 5MB)</small>
                </div>

                <div class="image-preview-section" id="imagePreviewSection" style="display: none;">
                    <div class="image-preview-container">
                        <img id="imagePreview" src="" alt="Preview">
                    </div>
                    <div class="image-controls">
                        <label>Zoom:</label>
                        <input type="range" id="imageZoom" min="100" max="200" value="100" oninput="adjustImageZoom(this.value)">
                        <button type="button" class="btn btn-secondary btn-sm" onclick="document.getElementById('imageUpload').click()">Change Image</button>
                    </div>
                </div>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeChangeImageModal()">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveImageBtn" onclick="saveProfileImage()" disabled>Save Image</button>
            </div>
        </div>
    </div>
</div>

<!-- Deactivate Account Modal -->
<div id="deactivateAccountModal" class="modal-overlay" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-header danger-header">
            <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px; vertical-align: middle; margin-right: 10px;">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
                Deactivate Account
            </h3>
            <button class="modal-close" onclick="closeDeactivateModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="warning-box">
                <h4>⚠️ Warning: This action cannot be undone!</h4>
                <p>Deactivating your account will permanently delete:</p>
                <ul>
                    <li>All your bookings</li>
                    <li>Your fishing history</li>
                    <li>Your profile information</li>
                    <li>Your member benefits</li>
                </ul>
            </div>

            <form id="deactivateForm" onsubmit="submitDeactivation(event)">
                <div class="form-group">
                    <label for="deactivateConfirm">
                        To confirm, type <strong>DELETE</strong> in the box below:
                    </label>
                    <input type="text" id="deactivateConfirm" required placeholder="Type DELETE" autocomplete="off" oninput="validateDeactivation()">
                    <span class="error-text" id="deactivateError"></span>
                </div>

                <div class="form-group">
                    <label for="deactivateReason">Reason for leaving (optional):</label>
                    <textarea id="deactivateReason" rows="3" placeholder="Help us improve..."></textarea>
                </div>

                <div class="contact-info-box">
                    <p><strong>Need help instead?</strong></p>
                    <p>Contact us before deactivating:</p>
                    <p>Michael: <a href="tel:07749135709">07749 135709</a></p>
                    <p>Ross: <a href="tel:07979521146">07979 521146</a></p>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeDeactivateModal()">Keep My Account</button>
                    <button type="submit" class="btn btn-danger" id="deactivateBtn" disabled>Deactivate Account</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Success Toast -->
<div id="successToast" class="toast success-toast" style="display: none;">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
    </svg>
    <span id="toastMessage">Success!</span>
</div>

<!-- Error Toast -->
<div id="errorToast" class="toast error-toast" style="display: none;">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="15" y1="9" x2="9" y2="15"></line>
        <line x1="9" y1="9" x2="15" y2="15"></line>
    </svg>
    <span id="errorToastMessage">Error!</span>
</div>









